<div class="card">
    <div class="card-body">
        <div class="d-flex justify-content-end">
            <div class="flex-grow-1">
                <h5 class="card-title">{{ user.fullName }}</h5>
                <h6 class="card-subtitle mb-2 mt-2 text-muted">Username: {{ user.username }}</h6>
                <p class="card-text">Email: {{ user.email }}</p>
                <p class="card-text">Mobile: {{ user.mobile }}</p>
                <p class="card-text">Created Date: {{ user.createdDate | date:'short' }}</p>
                <h5 class="card-text">Wallet Balance: {{ user.walletBalance | number:'1.2-2' }}</h5>
                <h5 class="card-text mt-1">Unlocked Balance: <span class="text-success">{{ user.unlocked |
                        number:'1.2-2' }}</span></h5>
                <h5 class="card-text mt-1">Locked Balance: <span class="text-danger">{{ user.locked | number:'1.2-2'
                        }}</span></h5>
            </div>
            <div class="ml-2">
                <div class="row mb-1 justify-content-end">
                    <span class="badge badge-info">1 coin is equal to 1000₹</span>
                </div>
                <div class="mt-2">
                <button class="btn btn-success mr-2" (click)="openLockUnlockModal(lockUnlockModal,'lock')">Add Lock
                    Coins</button>
                <button class="btn btn-warning mr-2" (click)="openLockUnlockModal(lockUnlockModal,'unlock')">Add Unlock
                    Coins</button>
                <button class="btn btn-info" (click)="openLockUnlockModal(fromUnlockedToLockedModal,'unlock')">Transfer
                    Coin</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-body">

        <ul ngbNav #nav="ngbNav" [activeId]="selectedTab" class="nav-tabs nav-tabs-custom">
            <li [ngbNavItem]="1" [destroyOnHide]="false" (click)="onTabChanged(1)">
                <a ngbNavLink>
                    <span class="d-block d-sm-none"><i class="fas fa-home"></i></span>
                    <span class="d-none d-sm-block">Transaction History</span>
                </a>
                <ng-template ngbNavContent>
                    <div class="container mt-2">
                        <div [ngStyle]="gridHeightWidth" class="mb-2">
                            <ag-grid-angular style="width: 100%; height:100%;" class="ag-theme-alpine" [rowData]="lst"
                                [rowHeight]="appCommon.GridRowHeight" [columnDefs]="columnDefs"
                                (gridReady)="onGridReady($event)" [animateRows]="true">
                            </ag-grid-angular>
                        </div>
                        <!-- <h4>Transaction History</h4>
                        <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                            <table class="table table-striped table-fixed">
                                <thead class="thead-light">
                                    <tr>
                                        <th>#</th>
                                        <th>Transaction Date</th>
                                        <th>Amount</th>
                                        <th>Description</th>
                                        <th>Recipient</th>
                                        <th>Status</th>
                                        <th>Transaction Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let transaction of lst; let i  = index ">
                                        <td>{{ i + 1 }}</td>
                                        <td>{{ transaction.transactionDate | date:'short' }}</td>
                                        <td>{{ transaction.amount | number:'1.2-2' }}</td>
                                        <td [innerHTML]="getArrowIcon(transaction.description) + ' ' + transaction.description"></td>
                                        <td>{{ transaction.recipientFullName }} ({{ transaction.recipientMobileNo }})
                                        </td>
                                        <td>
                                             <span class="badge"
                                                [ngClass]="{ 
                                                  'badge-success': transaction.status === 1, 
                                                  'badge-warning': transaction.status === 2,
                                                  'badge-danger': transaction.status === 3 
                                                }">
                                                {{ appCommon.EnTransactionStatusObjByte[transaction.status] }}
                                            </span> 
                                        </td>
                                        <td>{{appCommon.EnTransactionTypeObjByte[transaction.txnType]}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div> -->
                    </div>
                </ng-template>
            </li>
            <li [ngbNavItem]="2" [destroyOnHide]="false" (click)="onTabChanged(2)">
                <a ngbNavLink>
                    <span class="d-block d-sm-none"><i class="fas fa-home"></i></span>
                    <span class="d-none d-sm-block">Coin Log History</span>
                </a>
                <ng-template ngbNavContent>
                    <div class="container mt-2">
                        <div [ngStyle]="gridHeightWidth" class="mb-2">
                            <ag-grid-angular style="width: 100%; height:100%;" class="ag-theme-alpine" [rowData]="coinLoglst"
                                [rowHeight]="appCommon.GridRowHeight" [columnDefs]="columnDefsCoin"
                                (gridReady)="onCoinGridReady($event)" [animateRows]="true">
                            </ag-grid-angular>
                        </div>
                    </div>
                </ng-template>
            </li>
        </ul>
        <div [ngbNavOutlet]="nav"></div>
    </div>
</div>

<!-- Lock/Unlock Modal -->
<ng-template #lockUnlockModal let-modal>
    <div class="modal-header">
        <h5 class="modal-title">{{ modalTitle }}</h5>
        <button type="button" class="close" (click)="modal.dismiss('Cross click')" aria-hidden="true">×</button>
    </div>
    <div class="modal-body">
        <form (ngSubmit)="submitLockUnlockForm()">
            <div class="mb-3">
                <label for="amount" class="form-label">Amount</label>
                <input type="number" min="1" class="form-control" id="amount" [(ngModel)]="lockUnlockAmount"
                    name="amount" required
                    [ngClass]="{'is-invalid': lockUnlockAmount <= 0 && lockUnlockAmount !== null}">
                <div *ngIf="lockUnlockAmount <= 0 && lockUnlockAmount !== null" class="invalid-feedback">
                    Please enter a value greater than 0.
                </div>
            </div>
            <button type="submit" class="btn btn-primary" [disabled]="lockUnlockAmount <= 0">Submit</button>
        </form>
    </div>
</ng-template>


<ng-template #fromUnlockedToLockedModal let-modal>
    <div class="modal-header">
        <h5 class="modal-title">Transfer Coin Lock/Unlock</h5>
        <button type="button" class="close" (click)="modal.dismiss('Cross click')" aria-hidden="true">×</button>
    </div>
    <div class="modal-body">
        <form (ngSubmit)="submittransferCoins()">
            <div class="mb-3">
                <label for="amount" class="form-label">Amount</label>
                <input type="number" min="1" class="form-control" id="amount" [(ngModel)]="transferAmount" name="amount"
                    required [ngClass]="{'is-invalid': transferAmount <= 0 && transferAmount !== null}">
                <div *ngIf="transferAmount <= 0 && transferAmount !== null" class="invalid-feedback">
                    Please enter a value greater than 0.
                </div>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" [value]=false
                    [(ngModel)]="fromUnlockedToLocked" required [checked]="true">
                <label class="form-check-label" for="exampleRadios1">
                    Transfer Lock To Unlock
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" [value]=true
                    [(ngModel)]="fromUnlockedToLocked" required>
                <label class="form-check-label" for="exampleRadios2">
                    Transfer Unlock To Lock
                </label>
            </div>
            <button type="submit" class="btn btn-primary mt-2" [disabled]="transferAmount <= 0">Submit</button>
        </form>
    </div>
</ng-template>